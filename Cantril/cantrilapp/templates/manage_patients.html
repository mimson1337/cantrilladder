{% extends 'base.html' %}
{% block title %}Zarządzaj pacjentami{% endblock %}

{% block content %}
  <h1 class="center">Pacjenci</h1>

  <div class="card" style="margin-bottom:1rem;">
    <form method="post">
      {% csrf_token %}
      <label>PESEL</label>
      <input type="text" name="pesel" maxlength="11" required>
      <label style="margin-top:0.5rem;">Imię</label>
      <input type="text" name="first_name">
      <label style="margin-top:0.5rem;">Nazwisko</label>
      <input type="text" name="last_name">
      <label style="margin-top:0.5rem;">Data urodzenia</label>
      <input type="date" name="date_of_birth">
      <div style="margin-top:0.6rem; text-align:center;">
        <button class="btn" type="submit">Dodaj pacjenta</button>
      </div>
    </form>
  </div>

  <h3>Lista pacjentów</h3>
  <ul>
    {% for p in patients %}
      <li style="margin-bottom:0.5rem; display:flex; justify-content:space-between; align-items:center;">
        <div>
          <strong>{{ p.pesel }}</strong> {% if p.first_name or p.last_name %}- {{ p.first_name }} {{ p.last_name }}{% endif %}
          <div style="font-size:0.9rem; color:#666;">Utworzony: {{ p.created_at }}</div>
        </div>
        <form method="post" style="margin:0;">
          {% csrf_token %}
          <input type="hidden" name="patient_id" value="{{ p.id }}">
          <input type="hidden" name="action" value="delete">
          <button class="btn" type="submit" style="background:#dc3545;">Usuń</button>
        </form>
      </li>
    {% empty %}
      <li>Brak pacjentów</li>
    {% endfor %}
  </ul>
{% endblock %}
